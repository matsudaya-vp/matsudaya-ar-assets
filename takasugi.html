<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mindar-image-aframe.prod.js"></script>

    <style>
        #ui-container {
            position: fixed; bottom: 0; left: 0; width: 100%;
            display: flex; justify-content: center; padding: 20px; z-index: 1000;
        }
        #capture-button {
            padding: 15px 30px; font-size: 1.2em; background-color: #ffffff;
            color: #333333; border: 2px solid #333333; border-radius: 50px;
            cursor: pointer; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body style='margin : 0px; overflow: hidden;'>

    <a-scene 
        mindar-image="imageTargetSrc: https://matsudaya-vp.github.io/matsudaya-ar-assets/takasugi_kamon.mind; 
                      autoStart: true; filterMinCF: 1; filterBeta: 1; 
                      mirrorVideo: false; debug: true;"
        color-space="sRGB" 
        renderer="colorManagement: true, physicallyCorrectLights: true"
        vr-mode-ui="enabled: false" 
        device-orientation-permission-ui="enabled: false">
        
        <a-assets>
            <img id="characterTexture" src="shinshaku_takasugi_1.png">
        </a-assets>

        <a-entity mindar-image-target="targetIndex: 0">
            <a-entity rotation="0 0 0">
                <a-plane 
                    width="1.0" height="1.67"
                    position="0 0.835 0" rotation="0 0 0"
                    material="src: #characterTexture; transparent: true; alphaTest: 0.5; side: double;">
                </a-plane>
            </a-entity>
        </a-entity>

        <!-- „Ç´„É°„É©„ÇíÊúâÂäπÂåñ -->
        <a-camera active="true" position="0 0 0"></a-camera>
    </a-scene>

    <div id="ui-container">
        <button id="capture-button">üì∏ ÊíÆÂΩ±</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const captureButton = document.getElementById('capture-button');
            const scene = document.querySelector('a-scene');
            if (captureButton && scene) {
                captureButton.addEventListener('click', () => {
                    const canvas = scene.querySelector('canvas');
                    if (canvas) {
                        const dataURL = canvas.toDataURL('image/png');
                        const link = document.createElement('a');
                        link.download = 'matsudaya_ar_photo.png';
                        link.href = dataURL;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                    } else {
                        alert('AR„Ç∑„Éº„É≥„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ');
                    }
                });
            }
        });
    </script>
</body>
</html>
