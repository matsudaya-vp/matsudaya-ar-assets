<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸­å¤®åˆ‡ã‚Šå‡ºã— iPhone X/11/12 ç¸¦é•·æ’®å½±2228</title>
<style>
Â  body { margin:0; overflow:hidden; background:#000; }
Â  /* ã‚¹ãƒãƒ›ç”»é¢ã«ãƒ™ã‚¿è¡¨ç¤º */
Â  #video-feed, #character-overlay {
Â  Â  position:fixed; top:0; left:0; width:100%; height:100%; object-fit:cover;
Â  Â  z-index:1;
Â  }
Â  #character-overlay { z-index:2; }
Â  
Â  /* --- UIã‚³ãƒ³ãƒ†ãƒŠã®ä¿®æ­£ --- */
Â  #ui-container {
Â  Â  position:fixed; 
Â  Â  bottom:0; 
Â  Â  width:100%; 
Â  Â  /* ç¸¦æ–¹å‘ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç¢ºä¿ã—ã€ä¸­å¤®ã«é…ç½®ã™ã‚‹ãŸã‚Flexboxã‚’ä½¿ç”¨ */
Â  Â  height: 100px; /* UIé ˜åŸŸã®é«˜ã•ã‚’æŒ‡å®šï¼ˆä¾‹ã¨ã—ã¦100pxï¼‰ */
Â  Â  display:flex; 
Â  Â  justify-content:center; /* æ¨ªæ–¹å‘ã®ä¸­å¤®é…ç½® */
Â  Â  align-items:center; /* ç¸¦æ–¹å‘ã®ä¸­å¤®é…ç½® */
Â  Â  z-index:3;
Â  Â  /* èƒŒæ™¯ã‚’å°‘ã—é€éã•ã›ã¦è¦‹ã‚„ã™ãã™ã‚‹ */
Â  Â  background: rgba(0, 0, 0, 0.3);
Â  }
Â  
Â  /* --- æ’®å½±ãƒœã‚¿ãƒ³ã®ä¿®æ­£ --- */
Â  #capture-button {
Â  Â  /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¤§ããã—ã¦ãƒœã‚¿ãƒ³ã®ã‚µã‚¤ã‚ºã‚’æ‹¡å¤§ */
Â  Â  padding: 25px 50px; 
Â  Â  font-size: 1.8em; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’æ‹¡å¤§ */
Â  Â  
Â  Â  border-radius:50px; 
Â  Â  cursor:pointer; 
Â  Â  
Â  Â  /* ç›®ç«‹ã¤ã‚ˆã†ã«ç™½èƒŒæ™¯ã«æ¿ƒã„è‰²ã‚’é©ç”¨ */
Â  Â  background:#fff; 
Â  Â  color:#333;
Â  Â  border:4px solid #333; /* æ ç·šã‚’å¤ªãã™ã‚‹ */
Â  Â  box-shadow:0 6px 12px rgba(0,0,0,0.4); /* å½±ã‚’æ¿ƒãã™ã‚‹ */
Â  }
</style>
</head>
<body>
<video id="video-feed" autoplay playsinline></video>
<img id="character-overlay" src="pf-takasugi2.png" alt="é«˜æ‰æ™‹ä½œ">
<div id="ui-container"><button id="capture-button">ğŸ“¸ æ’®å½±</button></div>

<script>
const video = document.getElementById('video-feed');
const overlay = document.getElementById('character-overlay');
const captureButton = document.getElementById('capture-button');

// èƒŒé¢ã‚«ãƒ¡ãƒ©ï¼ˆé«˜è§£åƒåº¦ã‚’å¸Œæœ›ï¼‰
navigator.mediaDevices.getUserMedia({
Â  video: { facingMode: "environment", width: { ideal: 2436 }, height: { ideal: 1125 } }
}).then(stream => { video.srcObject = stream; })
Â  .catch(err => alert("ã‚«ãƒ¡ãƒ©ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼: " + err));

// æ’®å½±å‡¦ç†ï¼ˆç”»é¢ä¸­å¤®ã‚’åŸºæº–ã«HDåˆ‡ã‚Šå‡ºã—ï¼‰
captureButton.addEventListener('click', () => {
Â  const HD_W = 1080;Â  Â // åˆ‡ã‚Šå‡ºã—å¹…
Â  const HD_H = 1920;Â  Â // åˆ‡ã‚Šå‡ºã—é«˜ã•
Â  const canvas = document.createElement('canvas');
Â  canvas.width = HD_W;
Â  canvas.height = HD_H;
Â  const ctx = canvas.getContext('2d');

Â  // video ã®ä¸­å¤®ã‚’åˆ‡ã‚Šå‡ºã™
Â  const videoRatio = video.videoWidth / video.videoHeight;
Â  const canvasRatio = HD_W / HD_H;

Â  let srcW, srcH, srcX, srcY;
Â  if(videoRatio > canvasRatio){
Â  Â  srcH = video.videoHeight;
Â  Â  srcW = srcH * canvasRatio;
Â  Â  srcX = (video.videoWidth - srcW)/2;
Â  Â  srcY = 0;
Â  } else {
Â  Â  srcW = video.videoWidth;
Â  Â  srcH = srcW / canvasRatio;
Â  Â  srcX = 0;
Â  Â  srcY = (video.videoHeight - srcH)/2;
Â  }
Â  ctx.drawImage(video, srcX, srcY, srcW, srcH, 0, 0, HD_W, HD_H);

Â  // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒã‚‚ä¸­å¤®åŸºæº–ã§åˆ‡ã‚Šå‡ºã™
Â  const imgRatio = overlay.naturalWidth / overlay.naturalHeight;
Â  let imgW, imgH, imgX, imgY;
Â  if(imgRatio > canvasRatio){
Â  Â  imgH = overlay.naturalHeight;
Â  Â  imgW = imgH * canvasRatio;
Â  Â  imgX = (overlay.naturalWidth - imgW)/2;
Â  Â  imgY = 0;
Â  } else {
Â  Â  imgW = overlay.naturalWidth;
Â  Â  imgH = imgW / canvasRatio;
Â  Â  imgX = 0;
Â  Â  imgY = (overlay.naturalHeight - imgH)/2;
Â  }
Â  ctx.drawImage(overlay, imgX, imgY, imgW, imgH, 0, 0, HD_W, HD_H);

Â  // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ•ã‚¡ã‚¤ãƒ«å
Â  const now = new Date();
Â  const timestamp = now.toISOString().replace(/[-:T]/g,"").slice(0,14);
Â  const link = document.createElement('a');
Â  link.download = `matsudaya_photo_${timestamp}.png`;
Â  link.href = canvas.toDataURL("image/png");
Â  link.click();
});
</script>
</body>
</html>